<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Dart 분석</title>
        <link rel="stylesheet" href="/company-tables.css"/>
    </head>
    <body>
        <%- include('../common_html/main_title') %>
        <div class="main-body">
            <%- include('../common_html/menu') %>
            <div class="main-content">
                <div class="sub-title-wrap">
                    <span class="sub-title">공시검색</span>
                </div>
                <div class="main-tables-wrap">
                    <div class="company-list">
                    <input type="text" id="searchInput" placeholder="회사명 검색">
                        <table id="companyTable" class="company-table" border='1'>
                            <thead >
                                <tr>
                                    <th>종목코드</th>
                                    <th>고유코드</th>
                                    <th>회사명</th>
                                    <th>사업보고서 바로가기</th>
                                    <th>경실련 업종</th>
                                    <th>업종</th>
                                    <th>주요제품</th>
                                    <th>대표자명</th>
                                    <th>홈페이지</th>
                                    <th>지역</th>
                                </tr>
                            </thead>
                            <% companies.forEach(function(company) { %>
                            <tbody>
                                <tr>
                                    <td><%= company.company_code %></td>
                                    <td><%= company.primary_code %></td>
                                    <td><a href="/share-disclosure/majorstock/<%= company.primary_code %>"> <%= company.company_name %> </a></td>
                                    <td><a href="<%= company.company_report_url %>"><%= company.company_report_url %></a></td>
                                    <td><%= company.category %></td>
                                    <td><%= company.sector %></td>
                                    <td><%= company.main_product %></td>
                                    <td><%= company.ceo_name %></td>    
                                    <td><a href="<%= company.company_url %>"><%= company.company_url %></a></td>
                                    <td><%= company.location %></td>
                                </tr>                       
                            </tbody>
                            <% }) %>
                        </table>
                    </div>
                    <script>
                        document.getElementById("searchInput").addEventListener("keyup", function() {
                        let filter = this.value.toLowerCase();
                        let rows = document.querySelectorAll("#companyTable tbody tr");

                        rows.forEach(function(row) {
                            let companyName = row.cells[2].innerText.toLowerCase(); // 3번째 열: 회사명
                            if (companyName.indexOf(filter) > -1) {
                            row.style.display = "";
                            } else {
                            row.style.display = "none";
                            }
                        });
                        });
                    </script>
                    <div class="disclosure-detail">
                        <% if (companyData && companyData.status === "000") { %>
                            <h3>공시 목록</h3>
                            <table border="1">
                                <tr>
                                    <th>접수번호</th>
                                    <td><%= companyData.rcept_no %></td>
                                </tr>
                                <tr>
                                    <th>접수일자</th>
                                    <td><%= companyData.recpt_dt %></td>
                                </tr>
                                <tr>
                                    <th>고유번호</th>
                                    <td><%= companyData.corp_code %></td>
                                </tr>
                                <tr>
                                    <th>회사명</th>
                                    <td><%= companyData.corp_name %></td>
                                </tr>
                                <tr>
                                    <th>보고구분</th>
                                    <td><%= companyData.report_tp %></td>
                                </tr>
                                <tr>
                                    <th>대표보고자</th>
                                    <td><%= companyData.repror %></td>
                                </tr>
                                <tr>
                                    <th>보유주식등의 수</th>
                                    <td><%= companyData.stkqy %></td>
                                </tr>
                                <tr>
                                    <th>보유주식등의 증감</th>
                                    <td><%= companyData.stkqy_irds %></td>
                                </tr>
                                <tr>
                                    <th>보유비율</th>
                                    <td><%= companyData.stkrt %></td>
                                </tr>
                                <tr>
                                    <th>보유비율 증감</th>
                                    <td><%= companyData.stkrt_irds %></td>
                                </tr>
                                <tr>
                                    <th>주요체결 주식등의 수</th>
                                    <td><%= companyData.ctr_stkqy %></td>
                                </tr>
                                <tr>
                                    <th>주식체결 보유비율</th>
                                    <td><%= companyData.ctr_stkrt %></td>
                                </tr>
                                <tr>
                                    <th>보고사유</th>
                                    <td><%= companyData.report_resn %></td>
                                </tr>
                            </table>
                        <% } else if (companyData) { %>
                            <p>데이터 없음: <%= companyData.message %></p>
                        <% } %>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>