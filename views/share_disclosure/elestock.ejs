<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Dart 분석</title>
        <link rel="stylesheet" href="/company-tables.css"/>
    </head>
    <body>
        <%- include('../common_html/main_title') %>
        <div class="main-body">
            <%- include('../common_html/menu') %>
            <div class="main-content">
                <div class="sub-title-wrap">
                    <span class="sub-title">공시검색</span>
                </div>
                <div class="main-tables-wrap">
                    <div class="company-list">
                    <input type="text" id="searchInput" placeholder="회사명 검색">
                        <table id="companyTable" class="company-table" border='1'>
                            <thead >
                                <tr>
                                    <th>종목코드</th>
                                    <th>고유코드</th>
                                    <th>회사명</th>
                                    <th>사업보고서 바로가기</th>
                                    <th>경실련 업종</th>
                                    <th>업종</th>
                                    <th>주요제품</th>
                                    <th>대표자명</th>
                                    <th>홈페이지</th>
                                    <th>지역</th>
                                </tr>
                            </thead>
                            <% companies.forEach(function(company) { %>
                            <tbody>
                                <tr>
                                    <td><%= company.company_code %></td>
                                    <td><%= company.primary_code %></td>
                                    <td><a href="/share-disclosure/elestock/<%= company.primary_code %>"> <%= company.company_name %> </a></td>
                                    <td><a href="<%= company.company_report_url %>"><%= company.company_report_url %></a></td>
                                    <td><%= company.category %></td>
                                    <td><%= company.sector %></td>
                                    <td><%= company.main_product %></td>
                                    <td><%= company.ceo_name %></td>    
                                    <td><a href="<%= company.company_url %>"><%= company.company_url %></a></td>
                                    <td><%= company.location %></td>
                                </tr>                       
                            </tbody>
                            <% }) %>
                        </table>
                    </div>
                    <script>
                        document.getElementById("searchInput").addEventListener("keyup", function() {
                        let filter = this.value.toLowerCase();
                        let rows = document.querySelectorAll("#companyTable tbody tr");

                        rows.forEach(function(row) {
                            let companyName = row.cells[2].innerText.toLowerCase(); // 3번째 열: 회사명
                            if (companyName.indexOf(filter) > -1) {
                            row.style.display = "";
                            } else {
                            row.style.display = "none";
                            }
                        });
                        });
                    </script>
                    <div class="disclosure-detail">
                        <% if (companyData && companyData.status === "000" && companyData.list && companyData.list.length > 0) { %>
                            <h3>공시 목록</h3>

                            <table border="1" style="width: 40%; border-collapse: collapse;">
                                <thead>
                                    <tr>
                                        <th>번호</th>
                                        <th>접수번호</th>
                                        <th>접수일자</th>
                                        <th>고유번호</th>
                                        <th>회사명</th>
                                        <th>보고자</th>
                                        <th>임원(등기여부)</th>
                                        <th>임원 직위</th>
                                        <th>주요 주주</th>
                                        <th>특정 증권 등 소유 수</th>
                                        <th>특정 증권 등 소유 증감 수</th>
                                        <th>특정 증권 등 소유 비율</th>
                                        <th>특정 증권 등 소유 증감 비율</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <% companyData.list.forEach(function(item, idx) { %>
                                        <tr>
                                            <td><%= idx + 1 %></td>
                                            <td><%= item.rcept_no %></td>
                                            <td><%= item.rcept_dt %></td>
                                            <td><%= item.corp_code %></td>
                                            <td><%= item.corp_name %></td>
                                            <td><%= item.repror %></td>
                                            <td><%= item.isu_exctv_rgist_at %></td>
                                            <td><%= item.isu_exctv_ofcps %></td>
                                            <td><%= item.isu_main_shrholdr %></td>
                                            <td><%= item.sp_stock_lmp_cnt %></td>
                                            <td><%= item.sp_stock_lmp_irds_cnt %></td>
                                            <td><%= item.sp_stock_lmp_rate %></td>
                                            <td><%= item.sp_stock_lmp_irds_rate %></td>
                                        </tr>
                                    <% }); %>
                                </tbody>
                            </table>
                        <% } else { %>
                            <p>데이터가 없습니다.</p>
                        <% } %>
                        </div>
                </div>
            </div>
        </div>
    </body>
</html>